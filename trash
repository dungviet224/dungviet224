local Library = {}

-- Utility function to create UI elements
function Library:CreateElement(type, properties)
    local element = Instance.new(type)
    for property, value in pairs(properties) do
        element[property] = value
    end
    return element
end

-- Create a gradient color sequence
function Library:CreateGradient(color1, color2)
    return ColorSequence.new({
        ColorSequenceKeypoint.new(0, color1),
        ColorSequenceKeypoint.new(1, color2)
    })
end

-- Create a window (main container)
function Library:CreateWindow(name)
    local window = self:CreateElement("ScreenGui", {
        Name = name,
        Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")
    })

    local mainFrame = self:CreateElement("Frame", {
        Name = "MainFrame",
        Parent = window,
        Size = UDim2.new(0, 400, 0, 300),
        Position = UDim2.new(0.5, -200, 0.5, -150),
        BackgroundColor3 = Color3.fromRGB(25, 25, 25),
        BackgroundTransparency = 0.1,
        ClipsDescendants = true
    })

    local uiCorner = self:CreateElement("UICorner", {
        CornerRadius = UDim.new(0, 8),
        Parent = mainFrame
    })

    local uiStroke = self:CreateElement("UIStroke", {
        Thickness = 2,
        Color = Color3.fromRGB(50, 50, 50),
        Parent = mainFrame
    })

    local title = self:CreateElement("TextLabel", {
        Name = "Title",
        Parent = mainFrame,
        Size = UDim2.new(1, 0, 0, 40),
        Position = UDim2.new(0, 0, 0, 0),
        BackgroundColor3 = Color3.fromRGB(30, 30, 30),
        BackgroundTransparency = 0.5,
        Text = name,
        TextColor3 = Color3.fromRGB(255, 255, 255),
        TextSize = 18,
        Font = Enum.Font.GothamBold
    })

    local uiCornerTitle = self:CreateElement("UICorner", {
        CornerRadius = UDim.new(0, 8),
        Parent = title
    })

    local tabContainer = self:CreateElement("Frame", {
        Name = "TabContainer",
        Parent = mainFrame,
        Size = UDim2.new(1, 0, 0, 40),
        Position = UDim2.new(0, 0, 0, 40),
        BackgroundTransparency = 1
    })

    local contentContainer = self:CreateElement("Frame", {
        Name = "ContentContainer",
        Parent = mainFrame,
        Size = UDim2.new(1, 0, 1, -80),
        Position = UDim2.new(0, 0, 0, 80),
        BackgroundTransparency = 1
    })

    return {
        Window = window,
        MainFrame = mainFrame,
        TabContainer = tabContainer,
        ContentContainer = contentContainer
    }
end

-- Create a horizontal tab
function Library:CreateTab(window, name)
    local tabButton = self:CreateElement("TextButton", {
        Name = name,
        Parent = window.TabContainer,
        Size = UDim2.new(0.2, 0, 1, 0),
        Position = UDim2.new(0, 0, 0, 0),
        BackgroundColor3 = Color3.fromRGB(40, 40, 40),
        BackgroundTransparency = 0.5,
        Text = name,
        TextColor3 = Color3.fromRGB(255, 255, 255),
        TextSize = 14,
        Font = Enum.Font.Gotham
    })

    local uiCorner = self:CreateElement("UICorner", {
        CornerRadius = UDim.new(0, 8),
        Parent = tabButton
    })

    local tabContent = self:CreateElement("Frame", {
        Name = name .. "Content",
        Parent = window.ContentContainer,
        Size = UDim2.new(1, 0, 1, 0),
        Position = UDim2.new(0, 0, 0, 0),
        BackgroundTransparency = 1,
        Visible = false
    })

    tabButton.MouseButton1Click:Connect(function()
        for _, child in ipairs(window.ContentContainer:GetChildren()) do
            child.Visible = false
        end
        tabContent.Visible = true
    end)

    return tabContent
end

-- Create a button with auto-animation
function Library:CreateButton(parent, name, callback)
    local button = self:CreateElement("TextButton", {
        Name = name,
        Parent = parent,
        Size = UDim2.new(0.8, 0, 0, 40),
        Position = UDim2.new(0.1, 0, 0, 0),
        BackgroundColor3 = Color3.fromRGB(50, 50, 50),
        BackgroundTransparency = 0.5,
        Text = name,
        TextColor3 = Color3.fromRGB(255, 255, 255),
        TextSize = 14,
        Font = Enum.Font.Gotham
    })

    local uiCorner = self:CreateElement("UICorner", {
        CornerRadius = UDim.new(0, 8),
        Parent = button
    })

    local uiStroke = self:CreateElement("UIStroke", {
        Thickness = 1,
        Color = Color3.fromRGB(100, 100, 100),
        Parent = button
    })

    button.MouseButton1Click:Connect(function()
        self:Animate(button, "BackgroundTransparency", 0.2, 0.2, function()
            self:Animate(button, "BackgroundTransparency", 0.5, 0.2)
        end)
        callback()
    end)

    return button
end

-- Create a slider with auto-animation
function Library:CreateSlider(parent, name, min, max, callback)
    local slider = self:CreateElement("Frame", {
        Name = name,
        Parent = parent,
        Size = UDim2.new(0.8, 0, 0, 40),
        Position = UDim2.new(0.1, 0, 0, 50),
        BackgroundColor3 = Color3.fromRGB(40, 40, 40),
        BackgroundTransparency = 0.5
    })

    local uiCorner = self:CreateElement("UICorner", {
        CornerRadius = UDim.new(0, 8),
        Parent = slider
    })

    local sliderFill = self:CreateElement("Frame", {
        Name = "SliderFill",
        Parent = slider,
        Size = UDim2.new(0, 0, 1, 0),
        BackgroundColor3 = Color3.fromRGB(80, 80, 80)
    })

    local uiCornerFill = self:CreateElement("UICorner", {
        CornerRadius = UDim.new(0, 8),
        Parent = sliderFill
    })

    local sliderText = self:CreateElement("TextLabel", {
        Name = "SliderText",
        Parent = slider,
        Size = UDim2.new(1, 0, 1, 0),
        BackgroundTransparency = 1,
        Text = name .. ": " .. min,
        TextColor3 = Color3.fromRGB(255, 255, 255),
        TextSize = 14,
        Font = Enum.Font.Gotham
    })

    local isDragging = false
    slider.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            isDragging = true
        end
    end)

    slider.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            isDragging = false
        end
    end)

    game:GetService("UserInputService").InputChanged:Connect(function(input)
        if isDragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            local x = math.clamp(input.Position.X - slider.AbsolutePosition.X, 0, slider.AbsoluteSize.X)
            local value = math.floor(((x / slider.AbsoluteSize.X) * (max - min)) + min)
            self:Animate(sliderFill, "Size", UDim2.new(x / slider.AbsoluteSize.X, 0, 1, 0), 0.1)
            sliderText.Text = name .. ": " .. value
            callback(value)
        end
    end)

    return slider
end

-- Create a toggle with auto-animation
function Library:CreateToggle(parent, name, callback)
    local toggle = self:CreateElement("TextButton", {
        Name = name,
        Parent = parent,
        Size = UDim2.new(0.8, 0, 0, 40),
        Position = UDim2.new(0.1, 0, 0, 100),
        BackgroundColor3 = Color3.fromRGB(50, 50, 50),
        BackgroundTransparency = 0.5,
        Text = name .. ": Off",
        TextColor3 = Color3.fromRGB(255, 255, 255),
        TextSize = 14,
        Font = Enum.Font.Gotham
    })

    local uiCorner = self:CreateElement("UICorner", {
        CornerRadius = UDim.new(0, 8),
        Parent = toggle
    })

    local uiStroke = self:CreateElement("UIStroke", {
        Thickness = 1,
        Color = Color3.fromRGB(100, 100, 100),
        Parent = toggle
    })

    local toggled = false
    toggle.MouseButton1Click:Connect(function()
        toggled = not toggled
        self:Animate(toggle, "BackgroundTransparency", toggled and 0.2 or 0.5, 0.2)
        toggle.Text = name .. ": " .. (toggled and "On" or "Off")
        callback(toggled)
    end)

    return toggle
end

-- Smooth animation function
function Library:Animate(element, property, targetValue, duration, callback)
    local startValue = element[property]
    local step = (targetValue - startValue) / (duration * 60)

    for i = 1, duration * 60 do
        element[property] = element[property] + step
        wait(1 / 60)
    end

    if callback then
        callback()
    end
end

return Library
